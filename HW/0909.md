<!--
第二周

作业2：线性回归参数的递推更新与卡尔曼滤波思想.pdf
-->
# 第二周

![[作业2：线性回归参数的递推更新与卡尔曼滤波思想.pdf]]

167.88 KB

注意！请大家在交作业的时候，记得按规范的格式提交！

<!--
![](http://p.qpic.cn/homework/0/hw_h_1mbr6utdgq68sc068c11bf3f0bbf/)
-->
![](Assets/hw_h_1mbr6utdgq68sc068c11bf3f0bbf.png)

---

## Redefine the symbols
$$\begin{align}
n, \ d & \in \mathbb{N}^* \\
\prescript{0}{}{\mathbf{X}} \in \mathbb{R}^{d \times n}, \ \overrightarrow{\prescript{0}{}{y}} \in \mathbb{R}^n, & \ \overrightarrow{\prescript{0}{}{\theta}} \in \mathbb{R}^d, \ \overrightarrow{y^*} = \mathbf{X}^T \overrightarrow{\theta} \in \mathbb{R}^{n} \\
\prescript{0}{}{\mathbf{X}} \prescript{0}{}{\mathbf{X}}^T \overrightarrow{\prescript{0}{}{\theta}} & = \prescript{0}{}{\mathbf{X}} \overrightarrow{\prescript{0}{}{y}} \\
\end{align}$$
## Question 1: Adding samples
### Define symbols
$$
\mathbf{X} = (\prescript{0}{}{\mathbf{X}}, \overrightarrow{X_{n + 1}}) \in \mathbb{R}^{d \times (n + 1)}, \ \overrightarrow{y} = \begin{pmatrix}\begin{smallmatrix}\overrightarrow{\prescript{0}{}{y}} \\ y_{n + 1}\end{smallmatrix}\end{pmatrix} \in \mathbb{R}^{n + 1}, \ \overrightarrow{\theta} = \overrightarrow{\prescript{0}{}{\theta}} + \overrightarrow{\delta} \in \mathbb{R}^d
$$

### Answer
$$\begin{align}
\mathbf{X} \mathbf{X}^T \overrightarrow{\theta} & = \mathbf{X} \overrightarrow{y} \\
(\prescript{0}{}{\mathbf{X}}, \overrightarrow{X_{n + 1}}) (\prescript{0}{}{\mathbf{X}}, \overrightarrow{X_{n + 1}})^T (\overrightarrow{\prescript{0}{}{\theta}} + \overrightarrow{\delta}) & = (\prescript{0}{}{\mathbf{X}}, \overrightarrow{X_{n + 1}}) \begin{pmatrix}\begin{smallmatrix}\overrightarrow{\prescript{0}{}{y}} \\ y_{n + 1}\end{smallmatrix}\end{pmatrix} \\
(\prescript{0}{}{\mathbf{X}}, \overrightarrow{X_{n + 1}}) \begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}}^T \\ \overrightarrow{X_{n + 1}}^T\end{smallmatrix}\end{pmatrix} (\overrightarrow{\prescript{0}{}{\theta}} + \overrightarrow{\delta}) & = (\prescript{0}{}{\mathbf{X}}, \overrightarrow{X_{n + 1}}) \begin{pmatrix}\begin{smallmatrix}\overrightarrow{\prescript{0}{}{y}} \\ y_{n + 1}\end{smallmatrix}\end{pmatrix} \\
(\prescript{0}{}{\mathbf{X}} \prescript{0}{}{\mathbf{X}}^T + \overrightarrow{X_{n + 1}} \overrightarrow{X_{n + 1}}^T) (\overrightarrow{\prescript{0}{}{\theta}} + \overrightarrow{\delta}) & = \prescript{0}{}{\mathbf{X}} \overrightarrow{\prescript{0}{}{y}} + y_{n + 1} \overrightarrow{X_{n + 1}} \\
\prescript{0}{}{\mathbf{X}} \prescript{0}{}{\mathbf{X}}^T \overrightarrow{\prescript{0}{}{\theta}} + \overrightarrow{X_{n + 1}} \overrightarrow{X_{n + 1}}^T \overrightarrow{\prescript{0}{}{\theta}} + \prescript{0}{}{\mathbf{X}} \prescript{0}{}{\mathbf{X}}^T \overrightarrow{\delta} + \overrightarrow{X_{n + 1}} \overrightarrow{X_{n + 1}}^T \overrightarrow{\delta} & = \prescript{0}{}{\mathbf{X}} \overrightarrow{\prescript{0}{}{y}} + y_{n + 1} \overrightarrow{X_{n + 1}} \\
(\prescript{0}{}{\mathbf{X}} \prescript{0}{}{\mathbf{X}}^T + \overrightarrow{X_{n + 1}} \overrightarrow{X_{n + 1}}^T I_d) \overrightarrow{\delta} & = y_{n + 1} \overrightarrow{X_{n + 1}} - \overrightarrow{X_{n + 1}} \overrightarrow{X_{n + 1}}^T \overrightarrow{\prescript{0}{}{\theta}} \\
\overrightarrow{\delta} = (\prescript{0}{}{\mathbf{X}} \prescript{0}{}{\mathbf{X}}^T + \overrightarrow{X_{n + 1}} \overrightarrow{X_{n + 1}}^T I_d)^{-1} y_{n + 1} \overrightarrow{X_{n + 1}} & - \overrightarrow{X_{n + 1}} \overrightarrow{X_{n + 1}}^T \overrightarrow{\prescript{0}{}{\theta}}, \ \exists (\prescript{0}{}{\mathbf{X}} \prescript{0}{}{\mathbf{X}}^T + \overrightarrow{X_{n + 1}} \overrightarrow{X_{n + 1}}^T I_d)^{-1} \\
\end{align}$$

## Question 2: Adding features
### Define symbols
$$\begin{align}
\overrightarrow{\prescript{}{d + 1}{X}} = (\prescript{}{d + 1}{x_1}, \prescript{}{d + 1}{x_2}, \cdots, \prescript{}{d + 1}{x_n})^T \in \mathbb{R}^n, \ \overrightarrow{\delta} & \in \mathbb{R}^{d + 1} \\
\mathbf{X} = \begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}} \\ \overrightarrow{\prescript{}{d + 1}{X}}^T\end{smallmatrix}\end{pmatrix} \in \mathbb{R}^{(d + 1) \times n}, \ \overrightarrow{y} = \overrightarrow{\prescript{0}{}{y}} \in \mathbb{R}^{n}, \ \overrightarrow{\theta} = \begin{pmatrix}\begin{smallmatrix}\overrightarrow{\prescript{0}{}{\theta}} \\ 0\end{smallmatrix}\end{pmatrix} + \overrightarrow{\delta} & \in \mathbb{R}^{d + 1} \\
\end{align}$$

### Answer
$$\begin{align}
\mathbf{X} \mathbf{X}^T \overrightarrow{\theta} & = \mathbf{X} \overrightarrow{y} \\
\begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}} \\ \overrightarrow{\prescript{}{d + 1}{X}}^T\end{smallmatrix}\end{pmatrix} \begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}} \\ \overrightarrow{\prescript{}{d + 1}{X}}^T\end{smallmatrix}\end{pmatrix}^T (\begin{pmatrix}\begin{smallmatrix}\overrightarrow{\prescript{0}{}{\theta}} \\ 0\end{smallmatrix}\end{pmatrix} + \overrightarrow{\delta}) & = \begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}} \\ \overrightarrow{\prescript{}{d + 1}{X}}^T\end{smallmatrix}\end{pmatrix} \overrightarrow{y} \\
\begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}} \\ \overrightarrow{\prescript{}{d + 1}{X}}^T\end{smallmatrix}\end{pmatrix} (\prescript{0}{}{\mathbf{X}}^T, \overrightarrow{\prescript{}{d + 1}{X}}) (\begin{pmatrix}\begin{smallmatrix}\overrightarrow{\prescript{0}{}{\theta}} \\ 0\end{smallmatrix}\end{pmatrix} + \overrightarrow{\delta}) & = \begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}} \\ \overrightarrow{\prescript{}{d + 1}{X}}^T\end{smallmatrix}\end{pmatrix} \overrightarrow{y} \\
\begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}} \prescript{0}{}{\mathbf{X}}^T, \prescript{0}{}{\mathbf{X}} \overrightarrow{\prescript{}{d + 1}{X}} \\ \overrightarrow{\prescript{}{d + 1}{X}}^T \prescript{0}{}{\mathbf{X}}^T, \overrightarrow{\prescript{}{d + 1}{X}}^T \overrightarrow{\prescript{}{d + 1}{X}}\end{smallmatrix}\end{pmatrix} \begin{pmatrix}\begin{smallmatrix}\overrightarrow{\prescript{0}{}{\theta}} \\ 0\end{smallmatrix}\end{pmatrix} + \begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}} \prescript{0}{}{\mathbf{X}}^T, \prescript{0}{}{\mathbf{X}} \overrightarrow{\prescript{}{d + 1}{X}} \\ \overrightarrow{\prescript{}{d + 1}{X}}^T \prescript{0}{}{\mathbf{X}}^T, \overrightarrow{\prescript{}{d + 1}{X}}^T \overrightarrow{\prescript{}{d + 1}{X}}\end{smallmatrix}\end{pmatrix} \overrightarrow{\delta} & = \begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}} \\ \overrightarrow{\prescript{}{d + 1}{X}}^T\end{smallmatrix}\end{pmatrix} \overrightarrow{y} \\
\begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}} \prescript{0}{}{\mathbf{X}}^T \overrightarrow{\prescript{0}{}{\theta}} \\ \overrightarrow{\prescript{}{d + 1}{X}}^T \prescript{0}{}{\mathbf{X}}^T \overrightarrow{\prescript{0}{}{\theta}}\end{smallmatrix}\end{pmatrix} + \begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}} \prescript{0}{}{\mathbf{X}}^T, \prescript{0}{}{\mathbf{X}} \overrightarrow{\prescript{}{d + 1}{X}} \\ \overrightarrow{\prescript{}{d + 1}{X}}^T \prescript{0}{}{\mathbf{X}}^T, \overrightarrow{\prescript{}{d + 1}{X}}^T \overrightarrow{\prescript{}{d + 1}{X}}\end{smallmatrix}\end{pmatrix} \overrightarrow{\delta} & = \begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}} \overrightarrow{y} \\ \overrightarrow{\prescript{}{d + 1}{X}}^T \overrightarrow{y}\end{smallmatrix}\end{pmatrix} \\
\begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}} \prescript{0}{}{\mathbf{X}}^T, \prescript{0}{}{\mathbf{X}} \overrightarrow{\prescript{}{d + 1}{X}} \\ \overrightarrow{\prescript{}{d + 1}{X}}^T \prescript{0}{}{\mathbf{X}}^T, \overrightarrow{\prescript{}{d + 1}{X}}^T \overrightarrow{\prescript{}{d + 1}{X}}\end{smallmatrix}\end{pmatrix} \overrightarrow{\delta} & = \begin{pmatrix}\begin{smallmatrix}0 \\ \overrightarrow{\prescript{}{d + 1}{X}}^T \overrightarrow{y} - \overrightarrow{\prescript{}{d + 1}{X}}^T \prescript{0}{}{\mathbf{X}}^T \overrightarrow{\prescript{0}{}{\theta}}\end{smallmatrix}\end{pmatrix} \\
\overrightarrow{\delta} = \begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}} \prescript{0}{}{\mathbf{X}}^T, \prescript{0}{}{\mathbf{X}} \overrightarrow{\prescript{}{d + 1}{X}} \\ \overrightarrow{\prescript{}{d + 1}{X}}^T \prescript{0}{}{\mathbf{X}}^T, \overrightarrow{\prescript{}{d + 1}{X}}^T \overrightarrow{\prescript{}{d + 1}{X}}\end{smallmatrix}\end{pmatrix}^{-1} & \begin{pmatrix}\begin{smallmatrix}0 \\ \overrightarrow{\prescript{}{d + 1}{X}}^T \overrightarrow{y} - \overrightarrow{\prescript{}{d + 1}{X}}^T \prescript{0}{}{\mathbf{X}}^T \overrightarrow{\prescript{0}{}{\theta}}\end{smallmatrix}\end{pmatrix}, \ \exists \begin{pmatrix}\begin{smallmatrix}\prescript{0}{}{\mathbf{X}} \prescript{0}{}{\mathbf{X}}^T, \prescript{0}{}{\mathbf{X}} \overrightarrow{\prescript{}{d + 1}{X}} \\ \overrightarrow{\prescript{}{d + 1}{X}}^T \prescript{0}{}{\mathbf{X}}^T, \overrightarrow{\prescript{}{d + 1}{X}}^T \overrightarrow{\prescript{}{d + 1}{X}}\end{smallmatrix}\end{pmatrix}^{-1} \\
\end{align}$$
