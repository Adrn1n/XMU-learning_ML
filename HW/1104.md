# 1
## 1)
$$\begin{align}
\hat{p} = p(y = 1 | x) = \sigma{(w^T x + b)} & = \frac{1}{1 + e^{-(w^T x + b)}} \\
& = \frac{1}{1 + e^{-((0.2,-0.4) (1,2)^T + 0.1)}} \\
& = \frac{1}{1 + e^{\frac{1}{2}}} \\
\end{align}$$

## 2)
$$\begin{align}
\ell & = -(y \log{\hat{p}} + (1 - y) \log{(1 - \hat{p})}) \\
& = -(1 \times \ln{\frac{1}{1 + e^{\frac{1}{2}}}} + (1 - 1) \times \ln{(1 - \frac{1}{1 + e^{\frac{1}{2}}})}) \\
& = \ln{(1 + e^{\frac{1}{2}})} \\
\end{align}$$

## 3)
$$\begin{align}
\ell & = -(y \log{\hat{p}} + (1 - y) \log{(1 - \hat{p})}) \\
& = -(y \ln{\sigma{(w^T x + b)}} + (1 - y) \ln{(1 - \sigma{(w^T x + b)})}) \\
& = -(y \ln{\frac{1}{1 + e^{-(w^T x + b)}}} + (1 - y) \ln{(1 - \frac{1}{1 + e^{-(w^T x + b)}})}) \\
\therefore \frac{\mathrm{d}{\ell}}{\mathrm{d}{w_i}} & = (\frac{1 - y}{1 + e^{-(w^T x + b)}} - \frac{y}{1 + e^{w^T x + b}}) x_i \\
\therefore \nabla_w{\ell} & = ((\frac{1 - y}{1 + e^{-(w^T x + b)}} - \frac{y}{1 + e^{w^T x + b}}) x_1,(\frac{1 - y}{1 + e^{-(w^T x + b)}} - \frac{y}{1 + e^{w^T x + b}}) x_2)^T \\
& = ((\frac{1 - 1}{1 + e^{-((0.2,-0.4) (1,2)^T + 0.1)}} - \frac{1}{1 + e^{(0.2,-0.4) (1,2)^T + 0.1}}) \times 1,(\frac{1 - 1}{1 + e^{-((0.2,-0.4) (1,2)^T + 0.1)}} - \frac{1}{1 + e^{(0.2,-0.4) (1,2)^T + 0.1}}) \times 2)^T \\
& = (-\frac{1}{1 + e^{-\frac{1}{2}}},-\frac{2}{1 + e^{-\frac{1}{2}}})^T \\
\therefore \nabla_b{\ell} = \frac{\mathrm{d}{\ell}}{\mathrm{d}{b}} & = \frac{1 - y}{1 + e^{-(w^T x + b)}} - \frac{y}{1 + e^{w^T x + b}} \\
& = \frac{1 - 1}{1 + e^{-((0.2,-0.4) (1,2)^T + 0.1)}} - \frac{1}{1 + e^{(0.2,-0.4) (1,2)^T + 0.1}} \\
& = -\frac{1}{1 + e^{-\frac{1}{2}}} \\
\end{align}$$

## 4)
$$\begin{align}
w' & = w - \eta \nabla_w{\ell} \\
& = (0.2,-0.4)^T - 0.5 \times (-\frac{1}{1 + e^{-\frac{1}{2}}},-\frac{2}{1 + e^{-\frac{1}{2}}})^T \\
& = (\frac{1}{5} + \frac{1}{2 (1 + e^{-\frac{1}{2}})},\frac{1}{1 + e^{-\frac{1}{2}}} - \frac{2}{5})^T \\
\end{align}$$

# 2
## 1)
$$\begin{align}
l & : w^T x + b = 0 \\
& (1,-2) (x_1,x_2)^T - 0.5 = 0 \\
\overrightarrow{n} & = (1,-2) \\
\end{align}$$

## 2)
$$\begin{align}
w^T (x' + \lambda \overrightarrow{n}) + b & = 0 \\
(1,-2) ((1,1)^T + \lambda (1,-2)^T) - 0.5 & = 0 \\
\therefore \lambda & = 0.3 \\
\therefore y & = 0 \\
\end{align}$$

# 3
## 1)
Same as [1 3\)](##3\))
$$\begin{align}
\frac{\mathrm{d}{\ell}}{\mathrm{d}{w_i}} & = (\frac{1 - y}{1 + e^{-(w^T x + b)}} - \frac{y}{1 + e^{w^T x + b}}) x_i + \lambda w_i \\
\frac{\mathrm{d}{\ell}}{\mathrm{d}{b}} & = \frac{1 - y}{1 + e^{-(w^T x + b)}} - \frac{y}{1 + e^{w^T x + b}} \\
\end{align}$$

Therefore,
$$\begin{align}
\partial{\ell}/\partial{w} & = {((\frac{1 - y}{1 + e^{-(w^T x + b)}} - \frac{y}{1 + e^{w^T x + b}}) x_i + \lambda w_i,)_{i = 1}^{n}}^T \\
\partial{\ell}/\partial{b} & = \frac{1 - y}{1 + e^{-(w^T x + b)}} - \frac{y}{1 + e^{w^T x + b}} \\
\end{align}$$

## 2)
$$\begin{align}
\partial{\ell}/\partial{w} & = {((\frac{1 - y}{1 + e^{-(w^T x + b)}} - \frac{y}{1 + e^{w^T x + b}}) x_i + \lambda w_i,)_{i = 1}^{n}}^T \\
& = ((\frac{1 - 0}{1 + e^{-((0,1) (2,1)^T + 0)}} - \frac{0}{1 + e^{(0,1) (2,1)^T + 0}}) \times 2 + 1 \times 0,(\frac{1 - 0}{1 + e^{-((0,1) (2,1)^T + 0)}} - \frac{0}{1 + e^{(0,1) (2,1)^T + 0}}) \times 1 + 1 \times 1)^T \\
& = (\frac{2}{1 + e^{-1}},1 + \frac{1}{1 + e^{-1}})^T \\
\partial{\ell}/\partial{b} & = \frac{1 - y}{1 + e^{-(w^T x + b)}} - \frac{y}{1 + e^{w^T x + b}} \\
& = \frac{1 - 0}{1 + e^{-((0,1) (2,1)^T + 0)}} - \frac{0}{1 + e^{(0,1) (2,1)^T + 0}} \\
& = \frac{1}{1 + e^{-1}} \\
\end{align}$$
